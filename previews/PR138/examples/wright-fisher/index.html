<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wright-Fisher model of evolution · Agents.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Agents.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Agents.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../schelling/">Schelling&#39;s segregation model</a></li><li><a class="tocitem" href="../sir/">SIR model for the spread of COVID-19</a></li><li><a class="tocitem" href="../wealth_distribution/">Wealth distribution</a></li><li><a class="tocitem" href="../forest_fire/">Forest fire</a></li><li><a class="tocitem" href="../game_of_life_2D_CA/">Game of life</a></li><li><a class="tocitem" href="../rule22_1D_CA/">Rule 22</a></li><li class="is-active"><a class="tocitem" href>Wright-Fisher model of evolution</a><ul class="internal"><li><a class="tocitem" href="#A-neutral-model-1"><span>A neutral model</span></a></li><li><a class="tocitem" href="#A-model-with-selection-1"><span>A model with selection</span></a></li></ul></li><li><a class="tocitem" href="../HK/">Hegselmann-Krause opinion dynamics</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../mesa/">Comparison against Mesa (Python)</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Wright-Fisher model of evolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wright-Fisher model of evolution</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/Agents.jl/blob/master/examples/wright-fisher.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Wright-Fisher-model-of-evolution-1"><a class="docs-heading-anchor" href="#Wright-Fisher-model-of-evolution-1">Wright-Fisher model of evolution</a><a class="docs-heading-anchor-permalink" href="#Wright-Fisher-model-of-evolution-1" title="Permalink"></a></h1><p>This is one of the simplest models of population genetics that demonstrates the use of <a href="../../api/#Agents.sample!"><code>sample!</code></a>. We implement a simple case of the model where we study haploids (cells with a single set of chromosomes) while for simplicity focusing only on one locus (a specific gene). In this example we will be dealing with a population of constant size.</p><h2 id="A-neutral-model-1"><a class="docs-heading-anchor" href="#A-neutral-model-1">A neutral model</a><a class="docs-heading-anchor-permalink" href="#A-neutral-model-1" title="Permalink"></a></h2><ul><li>Imagine a population of <code>n</code> haploid individuals.</li><li>At each generation, <code>n</code> offsprings replace the parents.</li><li>Each offspring chooses a parent at random and inherits its genetic material.</li></ul><pre><code class="language-julia">using Agents
n = 100</code></pre><pre><code class="language-none">100</code></pre><p>Let&#39;s define an agent. The genetic value of an agent is a number (<code>trait</code> field).</p><pre><code class="language-julia">mutable struct Haploid &lt;: AbstractAgent
    id::Int
    trait::Float64
end</code></pre><p>And make a model without any spatial structure:</p><pre><code class="language-julia">m = ABM(Haploid)</code></pre><pre><code class="language-none">AgentBasedModel with 0 agents of type Haploid
 no space
 scheduler: fastest</code></pre><p>Create <code>n</code> random individuals:</p><pre><code class="language-julia">for i in 1:n
    add_agent!(m, rand())
end</code></pre><p>To create a new generation, we can use the <code>sample!</code> function. It chooses random individuals with replacement from the current individuals and updates the model. For example:</p><pre><code class="language-julia">sample!(m, nagents(m))</code></pre><pre><code class="language-none">AgentBasedModel with 100 agents of type Haploid
 no space
 scheduler: fastest</code></pre><p>The model can be run for many generations and we can collect the average trait value of the population. To do this we will use a model-step function (see <a href="../../tutorial/#Agents.step!"><code>step!</code></a>) that utilizes <a href="../../api/#Agents.sample!"><code>sample!</code></a>:</p><pre><code class="language-julia">modelstep_neutral!(m) = sample!(m, nagents(m))</code></pre><pre><code class="language-none">modelstep_neutral! (generic function with 1 method)</code></pre><p>We can now run the model and collect data. We use <code>dummystep</code> for the agent-step function (as the agents perform no actions).</p><pre><code class="language-julia">using Statistics: mean

data = step!(m, dummystep, modelstep_neutral!, 20, Dict(:trait =&gt; [mean]))</code></pre><table class="data-frame"><thead><tr><th></th><th>mean(trait)</th><th>step</th></tr><tr><th></th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>21 rows × 2 columns</p><tr><th>1</th><td>0.434245</td><td>0</td></tr><tr><th>2</th><td>0.478258</td><td>1</td></tr><tr><th>3</th><td>0.472828</td><td>2</td></tr><tr><th>4</th><td>0.417641</td><td>3</td></tr><tr><th>5</th><td>0.474695</td><td>4</td></tr><tr><th>6</th><td>0.481491</td><td>5</td></tr><tr><th>7</th><td>0.462107</td><td>6</td></tr><tr><th>8</th><td>0.451594</td><td>7</td></tr><tr><th>9</th><td>0.473883</td><td>8</td></tr><tr><th>10</th><td>0.4735</td><td>9</td></tr><tr><th>11</th><td>0.544481</td><td>10</td></tr><tr><th>12</th><td>0.558342</td><td>11</td></tr><tr><th>13</th><td>0.576316</td><td>12</td></tr><tr><th>14</th><td>0.562871</td><td>13</td></tr><tr><th>15</th><td>0.624478</td><td>14</td></tr><tr><th>16</th><td>0.616279</td><td>15</td></tr><tr><th>17</th><td>0.649077</td><td>16</td></tr><tr><th>18</th><td>0.66001</td><td>17</td></tr><tr><th>19</th><td>0.635411</td><td>18</td></tr><tr><th>20</th><td>0.643611</td><td>19</td></tr><tr><th>21</th><td>0.66001</td><td>20</td></tr></tbody></table><p>As expected, the average value of the &quot;trait&quot; remains around 0.5.</p><h2 id="A-model-with-selection-1"><a class="docs-heading-anchor" href="#A-model-with-selection-1">A model with selection</a><a class="docs-heading-anchor-permalink" href="#A-model-with-selection-1" title="Permalink"></a></h2><p>We can sample individuals according to their trait values, supposing that their fitness is correlated with their trait values.</p><pre><code class="language-julia">m = ABM(Haploid)
for i in 1:100
    add_agent!(m, rand())
end

modelstep_selection!(m::ABM) = sample!(m, nagents(m), :trait)

data = step!(m, dummystep, modelstep_selection!, 20, Dict(:trait =&gt; [mean]))</code></pre><table class="data-frame"><thead><tr><th></th><th>mean(trait)</th><th>step</th></tr><tr><th></th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>21 rows × 2 columns</p><tr><th>1</th><td>0.511277</td><td>0</td></tr><tr><th>2</th><td>0.673796</td><td>1</td></tr><tr><th>3</th><td>0.796682</td><td>2</td></tr><tr><th>4</th><td>0.897007</td><td>3</td></tr><tr><th>5</th><td>0.907747</td><td>4</td></tr><tr><th>6</th><td>0.948255</td><td>5</td></tr><tr><th>7</th><td>0.953115</td><td>6</td></tr><tr><th>8</th><td>0.963702</td><td>7</td></tr><tr><th>9</th><td>0.959919</td><td>8</td></tr><tr><th>10</th><td>0.967484</td><td>9</td></tr><tr><th>11</th><td>0.969862</td><td>10</td></tr><tr><th>12</th><td>0.971206</td><td>11</td></tr><tr><th>13</th><td>0.964248</td><td>12</td></tr><tr><th>14</th><td>0.966139</td><td>13</td></tr><tr><th>15</th><td>0.969777</td><td>14</td></tr><tr><th>16</th><td>0.972335</td><td>15</td></tr><tr><th>17</th><td>0.980656</td><td>16</td></tr><tr><th>18</th><td>0.979522</td><td>17</td></tr><tr><th>19</th><td>0.981097</td><td>18</td></tr><tr><th>20</th><td>0.982673</td><td>19</td></tr><tr><th>21</th><td>0.983808</td><td>20</td></tr></tbody></table><p>Here we see that as time progresses the trait comes closer and closer to 1, which is expected as agents with higher traits have higher probability of being sampled for the next &quot;generation&quot;.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../rule22_1D_CA/">« Rule 22</a><a class="docs-footer-nextpage" href="../HK/">Hegselmann-Krause opinion dynamics »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 17 March 2020 11:45">Tuesday 17 March 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
